## 目的
```

    当需要排查各种问题的时候、内存溢出、内存泄露时，当垃圾收集机制成为瓶颈时，需要对自动化进行异一定的监控。

```
## 回收哪里
```

    程序计数器、虚拟机栈、本地方法栈线程私有，线程没了，他自然没了，进栈出栈的东西在开始就已经确定了，确定性高。

    堆、方法区：不确定性高，不断的创建，垃圾进行回收。

```
## 回收哪里的谁，什么时候
```

    上帝：你要回收谁？

        魔鬼：回收死的，保留活的

    上帝：什么是死，什么是活？？

        魔鬼：被引用便是活，违被引用了便是死。

    上帝：什么样的是被引用了，什么样的是没有被引用？

        魔鬼：引用计数器   可达性判断
    
    上帝：什么时候回收我？？

        魔鬼：你与天地同在，~（感觉这就是跪舔）

==================================================
```  
### 引用计数器：
```

    给对象一个引用计数器，如果添加了一个引用，就将这个引用计数器加1，失去一个就将其减去1，如果计数器为0，那么就没被引用了。
    存在的问题就是引用链

```
### 可达性分析
```

    就是从GC Roots开始向下找，速索所走的路径，如果不可达，那么就没有被引用。

    引入和前面的两种引用方式，但是对于鸡肋来说，也就显得无能为力，那么鸡肋也是有其特有的引用方式，如果内存足够就留着，不够就采取果断措施。

```
### 引用
```

    引用分为:强引用、软引用、弱引用、虚引用，这四种的引用是逐渐减弱。

    强引用：
        一般就是new出来的，这样的存在就不会被清除，这个也是普遍存在的。
    软引用：
        这个就是鸡肋了，如果内存不够，那就进行回收，如果这次的回收，内存依旧不够使用的时候，就会发生第二次回收。
    弱引用:
        这个只可以活到下次回收之前，下一次垃圾回收就一定会被回收掉。和内存是没有关系的。
    虚引用：
        不会为生存时间造成影响，也无法通过它获得一个实例。
        我要这铁棒有何用~
        这个对象呗收集器回收时的一个系统通知
    
```
### 生存还是死亡（生死存亡之秋）
```

    生死存亡之秋：只能说很危险，不能说就死了呀。

    对于不可达的对象也就到达了这个地方，要真的死需要两次。
    第一次：帅选的条件是：是否有必要执行finalize()

    上帝：什么是有必要

        魔鬼：没有覆盖这个方法，或者说已经被调用过，就会被视为“没有必要执行”

    如果有必要执行finalize方法，那么这个对象就会防在一个队列中，并稍后有一个虚拟机自动建立，并有一个线程优先级低的线程去执行它【他是不保证等待他执行成功的，因为如果这个方法执行缓慢，可能会导致等待，导致整个回收系统无法使用】

    稍后GC在来执行标记
        如果链上了，就溢出即将回收集合
        未链上，就会被回收
    
    案例：
    SAVE_HOOK = new FinalizeEscapeGC();

		//对象第一次成功拯救自己
		SAVE_HOOK = null;
		System.gc();
		// 因为Finalizer方法优先级很低，暂停0.5秒，以等待它
		Thread.sleep(500);
		if (SAVE_HOOK != null) {
			SAVE_HOOK.isAlive();
		} else {
			System.out.println("no, i am dead :(");
		}

		// 下面这段代码与上面的完全相同，但是这次自救却失败了
		SAVE_HOOK = null;
		System.gc();
		// 因为Finalizer方法优先级很低，暂停0.5秒，以等待它
		Thread.sleep(500);
		if (SAVE_HOOK != null) {
			SAVE_HOOK.isAlive();
		} else {
			System.out.println("no, i am dead :(");
		}
        上面有两段代码是一样的，但是打印的结果是不一样的
        第一次是活的，第二次是死的。

        finalize()这个方法可以救他们，但是只是可以被执行一次。

    补充：finalize()具有不确定性，执行也是不确定的，虽然可以关闭资源，但是也不是很推荐。
    关闭资源可以使用try finally

    