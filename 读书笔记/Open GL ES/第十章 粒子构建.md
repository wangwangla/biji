# 粒子

- 创建一个粒子着色器

  - 解决的问题

    他可以存储所以的粒子，如果大量创建，太浪费了，所以我们把粒子存储在一个固定大小的数组中。我们需要就需要将数组下标加1，然后接着执行，如果内存不足，那就结束，从头开始进行。

    还需要一个绘制点，这个点可以是任意图像，并且每一个点都有唯一的一个颜色。

  - 着色器的创建，首先每个粒子有坐标，时间久了，就会运动的源，粒子的方向。

    ```
    着色器代码
    uniform mat4 u_Matrix;   变换矩阵
    uniform float u_Time;	当前时间
    
    attribute vec3 a_Position;  位置
    attribute vec3 a_Color;  颜色
    attribute vec3 a_DirectionVector;  方向
    attribute vec3 a_ParticleStartTime;  开始时间
    
    varying vec3 v_Color; 颜色
    varying float v_ElapsedTime; 运动的时间
    
    void main()
    {
        v_Color = a_Color;
        v_ElapsedTime = u_Time - a_ParticleStartTime;
        vec3 currentPosition = a_Position+(a_DirectionVector * v_ElapsedTime);
        gl_Postion = u_Matrix * vec4(currentPosition,1.0);
        gl_PointSize = 10.0;
    }
    ```

    一个点是有四个点的，但是为了防止和w发生混乱，那么就需要将3分量的向量表示位置和方向，当需要和u_Mathrix相乘的是才将其变为4维的。这样可以确保在求位置的时候，不至于和w搞混了。

    ```
    片段着色器
    precision mediump float；
    varying vec3 v_Color;
    varying float v_ElapsedTime;
    
    void main()
    {
        gl_FragColor = vec4(v_Color/v_ElapsedTime,1.0);
    }
    ```

    

  - 创建一个粒子系统

    开辟空间、设置粒 子个数，顶点确定。

    

  - 